
<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">

<HTML>
    <HEAD>
        <TITLE>
            How it works
        </TITLE>
        <LINK REV="made" HREF="mailto:USERNAME@HOSTNAME">
    </HEAD>
    <BODY BGCOLOR="ffffff">
        <CENTER>
            <TABLE BORDER=0 CELLPADDING=1>
                <TR>
                    <TD>
                        <A HREF="http://www.math.utah.edu/~alfeld/">
                            <FONT size = "-1">
                                <B> Peter Alfeld</B>
                            </FONT>
                        </A>
                    </TD>
                    <TD>
                        <A HREF="http://www.math.utah.edu/">
                            <FONT size = "-1">
                                <B> Department of Mathematics</B>
                            </FONT>
                        </A>
                    </TD>
                    <TD>
                        <A HREF="http://www.science.utah.edu/">
                            <FONT size = "-1">
                                <B> College of Science</B>
                            </FONT>
                        </A>
                    </TD>
                    <TD>
                        <A HREF="http://www.utah.edu/HTML_Docs/UofU_Home.html">
                            <FONT size = "-1">
                                <B> University of Utah</B>
                            </FONT>
                        </A>
                    </TD>
                </TR>
                <TD colspan = 4>
                    <APPLET CODE="MDS.class"
                        WIDTH = 700 HEIGHT = 55 VSPACE = 5>
                        <B>
                    </APPLET>
                </TD>
            </TR>
            <TR>
                <TD colspan = "2">
                    <A HREF="bform.html">
                        <FONT size = "-1">
                            <B> The Bernstein B&eacute;zier Form</B>
                        </FONT>
                    </A>
                </TD>
                <TD>
                    <A HREF="index.html">
                        <FONT size = "-1">
                            <B> Home Page</B>
                        </FONT>
                    </A>
                </TD>
                <TD>
                    <A HREF="examples.html">
                        <FONT size = "-1">
                            <B> Examples</B>
                        </FONT>
                    </A>
                </TD>
                <TD>
                </TR>
                <TR>
                    <TD COLSPAN="2">
                        <A HREF="Srd.html">
                            <FONT size = "-1">
                                <B> Spline Spaces and Minimal
                                Determining Sets</B>
                            </FONT>
                        </A>
                        &nbsp;&nbsp;
                    </TD>
                    <TD>
                        <A HREF="guide.html">
                            <FONT size = "-1">
                                <B> User's Guide</B>
                            </FONT>
                        </A>
                    </TD>
                    <TD>
                        <A HREF="residual.html">
                            <FONT size = "-1">
                                <B>Residual Arithmetic</B>
                            </FONT>
                        </A>
                    </TD>
                </TR>
                <TR>
                    <TD COLSPAN="2">
                        <A HREF="triangulation.html">
                            <FONT size = "-1">
                                <B>Triangulations</B>
                            </FONT>
                        </A>
                    </TD>
                    <TD>
                        <A HREF="how.html">
                            <FONT size = "-1">
                                <B>How does it work?</B>
                            </FONT>
                        </A>
                        &nbsp;&nbsp;
                    </TD>
                    <TD>
                        <A HREF="bibliography.html">
                            <FONT size = "-1">
                                <B>Bibliography</B>
                            </FONT>
                        </A>
                    </TD>
                </TR>
            </TABLE>
        </CENTER>
    <HR>


<BR CLEAR="ALL">

<H2>How Does it Work?</H2>
 
<p> Let's denote the underlying <a href="Srd.html">spline space</a> by <em>S</em> and suppose
that the polynomial degree is <em>d</em> and the degree of smoothness
is <em>r.</em>

<p> We need to analyze <a href="bform.html">smoothness conditions</a>
of the form <p> <IMG SRC="h1.gif"> (1)
<p>The <em>c<sub>ijk</sub></em>
are B&eacute;zier ordinates</em> (or just <em>coefficients</em>), and <em>A<sub>1</sub></em>,
<em>A<sub>2</sub></em>, and <em>A<sub>3</sub></em> are barycentric
coordinates of a vertex of a triangle with respect to the opposite
triangle.

<p> It is crucial that the coordinates of the vertices of the
underlying triangles are the coordinates of pixels and thus
<b>integers</b>. The barycentric coordinates <em>A<sub>i</sub></em>
are therefore <b>rational</b> and indeed all the coefficients in the
system (1) are rational.  We may assume (after multiplying with a
common denominator) that our homogeneous linear system has
<b>integer</b> coefficients.

<p> The reason this is important is that the dimension of a spline
space <em>S</em> and the composition of <a href="Srd.html">minimal
determining sets</a> depends discontinuously on the coefficients in
(1).  There are <a href="examples.html">examples</a> and <a
href="subtleties.html"> subtleties</a> that render the ordinary
floating point arithmetic unsuitable for this application.

<p> On this page we analyze the system (1) as an integer system for
convenience, but the <a href="residual.html">actual arithmetic</a> is
carried out modulo one or more large prime numbers.

<p> Thus we consider the homogeneous system
<p><IMG SRC="h2.gif"> (2)

<p> Each B&eacute;zier ordinate corresponds to a unique domain point
and vice versa.  The usual terminology refers to domain points rather
than corresponding B&eacute;zier ordinates and we adopt it here.  Thus
a <a href="Srd.html"> a determining set</a> is a set of domain points
which is such that if the corresponding coefficients are set to zero
than all other coefficients of the spline must also be zero.  A
<em>minimal determining set</em> is one that's no larger than any
other determining set.  The number of points in a minimal determining
set equals the dimension of S.


<BR CLEAR="ALL"><IMG SRC="example2.gif" ALIGN = "RIGHT">

<p> Some B&eacute;zier ordinates (those at a distance greater than <em>r</em>
from any edge) do not enter the smoothness conditions at all.  They
correspond to zero columns of <em>A</em> in (2).  We call these B&eacute;zier
ordinates <em>inactive</em> and the others <em>active.</em>  We omit
columns corresponding to inactive points from <em>A</em>.  Thus
<em>A</em> is a <em>u</em> by <em>v</em> matrix where <em>u</em> is
the number of smoothness conditions of the form (1) and <em>v</em> is
the number of active domain points.

<p> The dimension of <em>S</em> equals <em>i+v-m</em> where <em>i</em>
is the number of inactive domain points and <em>m</em> is the rank of
<em>A</em>.

<p> The nearby figure illustrates these concepts.  Inactive points are
marked with yellow or red square boxes. Active points in the minimal
determining set are indicated by red, blue and yellow plus signs.
Active points not in the minimal determining set are indicated by
colored circles.  The number of points in the minimal determinng set,
and thus the dimension of <em>S</em> is 33.

<p> Note: The colors illustrate the way the minimal determining set is
constructed, red points go with boundary vertices, blue points go
with the interior vertex, and yellow points go with nearby edges.  For
more information read about the <a href="examples.html">Morgan-Scott
Idea</a>.

<h3>Initialization</H3>

<p>We begin by using Gaussian Elimination to transform A into a block
matrix
<p><IMG SRC="h3.gif">
<p>where <em>D</em> is an <em>m</em> by <em>m</em> nonsingular diagonal matrix and
<em>A<sub>M</sub></em> is an <em>m</em> by <em>n</em> matrix.  As
above, <em>m</em> is the rank of <em>A</em> and <em>n</em> is the
number of <em>active points in a minimal determining set.</em>  (There
may be additional inactive points which are in every determining set).

<p>  We denote the nonzero <em>(i,i)</em> entry of <em>D</em> by <em>d<sub>i</sub></em>, i.e.,
<p><IMG SRC="h14.gif">

<p> The Gaussian elimination process uses total pivoting, but since we
are using integer arithmetic we are not concerned about stability.  So
we pick the first non-zero element in the part of the matrix that has
not yet been reduced.  Since we cannot use division the usual process
has to be modified and is described (for the <em>u</em> by <em>v</em>
matrix <em>A</em>) in the nearby box.  That process is followed by a similar one that reduces
<em>D</em> to diagonal form.

<IMG SRC="h4.gif" Border = "1" ALIGN = "RIGHT" vspace="5" hspace = "5">

<p> In this manner we obtain an initial minimal determining set containing
all the points corresponding to the columns of <em>A<sub>M</sub></em>.
The user of the applet does not know of that set but it is used
internally by the applet to construct the set actually wanted by the
user.

<H3>Adding and Removing Points</H3>

<p> We denote by <em>M</em>  the set of
points corresponding to the columns of <em>A<sub>M</sub></em> and by
<em>I</em> the set of remaining active points (corresponding to the
columns of the diagonal matrix <em>D</em>).

<p>We now think of <em>I</em> and <em>M</em> as each being composed of two sets:
<p><IMG SRC="h5.gif">
<p> where 
<em>M<sub>1</sub></em> is the set of points we have already picked to be in the minimal
determining set, and <em>M<sub>2</sub></em> is a set of points whose status is as yet
unknown.  Initially <em>M<sub>1</sub></em> is empty and <em>M<sub>2</sub>=M</em>.

<p>Similarly, we write <p><IMG SRC="h6.gif"> 
<p>where <em>I<sub>1</sub></em> is the set of points that we know to
be determined by our growing minimal determining set
<em>M<sub>1</sub></em>, and <em>I<sub>2</sub></em> is a set of points
whose status we do not yet know.  Initially, <em>I<sub>1</sub></em> is
empty, and <em>I<sub>2</sub> = I</em>.

<p>As in the simplex method for the solution of linear programming problems, we think of the rows of
<em>A<sub>M</sub></em> as labeled by the indices in <em>I</em> and the
columns by the points in <em>M</em>.  For points <em>p</em> in <em> I</em> and
<em>q </em> in <em> M</em> the notation <em>a<sub>pq</sub></em> means the
entry in <em>M</em> in the location <em>(p<sub>i</sub>,
q<sub>j</sub>)</em> where <em>p<sub>i</sub></em> and
<em>q<sub>j</sub></em> are the physical row and column indices
associated with <em>i</em> and <em>j</em>.

<p> It is now easy to tell whether a point <em>p</em> in <em>I</em> is
determined by the points in <em>M<sub>2</sub></em>:

<p> <b>Criterion:</b> <em>A point p in I is in I<sub>1</sub> if an
only if the row of M<sub>2</sub> corresponding to p is zero.</em>

<p> The <em>if</em> direction is obvious.  The <em>only if</em>
direction follows from the observation below that if that row in
<em>M<sub>2</sub></em> has non-zero entries then we can add <em>p</em>
to our growing minimal determining set.

<p> We now examine what happens when a user adds a point or removes one from the growing minimal determining set. Consider these cases:

<OL>

<li> <b><em>p is in M<sub>2</sub></em></b>.  We transfer <em>p</em>
from <em>M<sub>2</sub></em> to <em>M<sub>1</sub></em>, and check if this implies any
additions to <em>I<sub>1</sub></em> (by seeing if we have any new zero rows in
the matrix corresponding to the reduced set <em>M<sub>2</sub></em>.
</li>

<li>
<b><em>p is in I<sub>2</sub>.</em></b>

In that case we exchange <em>p</em> for a point <em>q</em> in <em> M<sub>2</sub></em> and change the 
matrix <em>M</em> appropriately.  We denote new entries of <em>M</em> by bars.


<p>First we find a point <em>q</em> in <em> M<sub>2</sub></em> such that
<p><IMG SRC="h16.gif">
<p>This is always
possible  because
otherwise <em>p</em> would be in <em>I<sub>1</sub></em>, i.e., it would be determined by the
points in the set <em>M<sub>1</sub></em> that we have already picked.

<p>The equation in the row corresponding to <em>p</em> reads:
<p><IMG SRC="h17.gif"> (3)
<p>In this row we make no change, except that since we will exchange <em>p</em>
and <em>q</em>, <em>d<sub>p</sub></em> and <em>a<sub>pq</sub></em>
exchange their roles (and maintain their  
numerical value).

<p>The equation corresponding to <em>w</em> different from <em>p</em> (or <em>q</em> after the exchange of
<em>p</em> and <em>q</em>) reads similarly:
<p><IMG SRC="h18.gif"> (4)
<p>We want to eliminate the entries in the
column corresponding to <em>q</em>.  To this end we replace the equation
(4) with
<p>a<sub>wq</sub><em> (3) - a<sub>pq</sub>(4)</em>
<p>which gives:
<p><IMG SRC="h20.gif">



<p>We thus modify the remaining entries of <em>A</em> as follows:

<p><IMG SRC="h21.gif">

<p>Finally, we move <em>p</em> to <em>M<sub>1</sub></em>, <em>q</em> to <em>I<sub>2</sub></em>,
and check for an increase in <em>I<sub>1</sub></em> as above.

</li>

<li>

<b><em>Retracting a point.</em></b>

To remove a point from <em>M<sub>1</sub></em> we move it to <em>M<sub>2</sub></em> and make any implied
moves from <em>I<sub>1</sub></em> to <em>I<sub>2</sub></em>.




</li>
</OL>

<h3><a href="residual.html">
Residual Arithmetic</a></h3>

  Carrying out the operations exactly as described here would quickly
  lead to an overflow of the integer arithmetic built into Java.
  Therefore the program actually represents (large) integers by their
  <a href="residual.html">
  remainders with respect to one or more large prime numbers.</a>

    <HR>
    [30-Jul-2003]
</BODY>
</HTML>
